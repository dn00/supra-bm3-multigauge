#:kivy 1.0.0
#:import Animation kivy.animation.Animation
#:import MDChip kivymd.uix.chip.MDChip
#:import MDChip kivymd.uix.chip.MDChipText
#:import MDSlider kivymd.uix.slider.MDSlider
#:import math math

#V1.0.0

# Set Global Font Types to save typing later
#:set GaugeFont "data/fonts/Eurostile LT Std Medium.ttf"
#:set ButtonFont "data/fonts/Eurostile LT Std Extended 2.ttf"

BoxLayout:
    orientation: 'vertical'
    ScreenManager:
        id: sm
        Gauge1Screen:
            name: 'gauge1'
            FloatLayout:
                canvas.before:
                    Color:
                        rgba: 0, 0, 0, 1
                    Rectangle:
                        size: self.size
                        pos: self.pos
          
                CustomGauge:
                    label_text: str(app.Ign1Timing) + 'Â°'
                    label_font_size: 24
                    gauge_image: "data/gauges/S2K_Timing.png"
                    gauge_bars: str(app.Ign1Timing_Image)
                    pos_hint: {'center_x': 0.5, 'center_y': 0.5}
                    pos: 180, 330
                    gauge_size: 240
                CustomGauge:
                    label_text: str(app.AFR)
                    label_font_size: 24
                    label_unit_text: "AFR"
                    gauge_image: "data/gauges/S2K_Timing.png"
                    gauge_bars: str(app.AFR_Image)
                    pos_hint: {'center_x': 0.5, 'center_y': 0.5}
                    pos: -60, 330
                    gauge_size: 240
                CustomGauge:
                    label_text: str(app.OilTemp)
                    label_font_size: 24
                    label_unit_text: "psig"
                    gauge_image: "data/gauges/supra_turbo.png"
                    gauge_bars: str(app.OilTemp_Image)
                    pos_hint: {'center_x': 0.5, 'center_y': 0.5}
                    pos: -20, 480
                    gauge_size: 350
 
                RelativeLayout:
                    pos: 2,-15
                    ReadoutGauge:
                        label_text: "Eth"
                        label_unit_text: " %   " 
                        label_font_size: 32
                        label_font_name: GaugeFont
                        value_font_name: GaugeFont
                        value_size: 24
                        value: str(app.BM3EthanolPercent)
                        pos: 42, 300
                        size: 20, 10
                    ReadoutGauge:
                        label_text: "IAT"
                        label_unit_text: "F   " 
                        label_font_size: 32
                        label_font_name: GaugeFont
                        value_font_name: GaugeFont
                        value_size: 24
                        value: str(app.IntakeAirTemp)
                        pos: 306, 300
                        size: 20, 10
                    ReadoutGauge:
                        label_text: "Oil-T"
                        label_unit_text: "F   " 
                        label_font_size: 32
                        label_font_name: GaugeFont
                        value_font_name: GaugeFont
                        value_size: 24
                        value: "0"
                        pos: 218, 300
                        size: 20, 10
                    ReadoutGauge:
                        label_text: "CL-T"
                        label_unit_text: "F   " 
                        label_font_size: 32
                        label_font_name: GaugeFont
                        value_font_name: GaugeFont
                        value_size: 24
                        value: str(app.CoolantTemp)
                        pos: 130, 300
                        size: 20, 10
          
        
                # # Rounded Button
                # Button:
                #     text: 'brr'
                #     font_name: ButtonFont
                #     font_size: 12
                #     size_hint: 0.09, 0.05
                #     # pos_hint: {'center_x': 0.04, 'center_y': 0.05}
                #     pos: 10, 10
                #     on_press: root.manager.current = 'gauge2'
                  
                # Button:
                #     text: 'brrbrr'
                #     font_name: ButtonFont
                #     font_size: 12
                #     size_hint: 0.09, 0.05
                #     # pos_hint: {'center_x': 0.04, 'center_y': 0.05}
                #     pos: 120, 10
                #     on_press: root.manager.current = 'gauge2'
                  
            StatusBar:
                size_hint_y: None
                height:38
                width: 800
                pos_hint: {"top": .99}  # This positions it at the top of the FloatLayout
                padding: 6,6,6,6
                StatusChip:
                    color: 0, 0, 0, 1
                    chip_text: "Wifi"
                    failed_color: 0.5, 0.5, 0.5, 1
                    failed: len(app.ssid) == 0
                    active: False
                StatusChip:
                    color: 0, 0, 0, 1
                    chip_text: "BM3"
                    failed: not app.BM3Connected
                    active: app.BM3Connecting
                StatusChip:
                    color: 0, 0, 0, 1
                    chip_text: "ETH"
                    failed: not app.BM3Connected or not 7 <= app.BM3EthanolPercent <=50
                    # active: True
                StatusChip:
                    color: 0, 0, 0, 1
                    chip_text: "LETS GO"
                    failed: not app.LETS_FUCKING_GO
                # MDSlider:
                #     pos: 10, 10
                #     min: 0
                #     max: 12
                #     size_hint: None, None
                #     height: 50
                #     width: 500
            
        InfoScreen:
            name: 'info'
            FloatLayout:
                Label:
                    text: 'SSID: ' + app.WifiNetwork
                    color: 1, 1, 1, 1  # Set text color to white
                    md_bg_color: 0, 0, 0, 0  # Fully transparent background (R, G, B, Alpha)
                    line_color: 1, 1, 0, 1  # Bright yellow line color (R, G, B, Alpha)
                    size_hint: None, None  # Disable size_hint to use explicit size
                    width: 70
                    line_width: 1  # Adjust the width of the border line as needed
                    check: False  # Set to False if you don't want the check icon           
            
        InfoScreen:
            name: 'info'
            FloatLayout:
                Label:
                    text: 'SSID: ' + app.WifiNetwork